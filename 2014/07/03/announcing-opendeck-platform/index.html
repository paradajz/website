<!DOCTYPE html> <html lang="zxx"> <head> <!-- meta --> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width,initial-scale=1"> <meta name="description" content=""> <meta name="keywords" content=""> <!-- Facebook Open Graph --> <meta content="Shantea Controls" property="og:site_name"> <meta property="og:locale" content="en_US"> <meta content="Announcing OpenDeck platform" property="og:title"> <meta content="article" property="og:type"> <meta content="" property="og:description"> <meta content="https://shanteacontrols.com/2014/07/03/announcing-opendeck-platform/" property="og:url"> <meta content="" property="og:image"> <meta content="announce" property="article:tag"> <meta content="opendeck" property="article:tag"> <meta content="programming" property="article:tag"> <meta content="2014-07-03T00:00:00+00:00" property="article:published_time"> <!-- Twitter cards --> <meta name="twitter:site" content="@"> <meta name="twitter:creator" content="@"> <meta name="twitter:title" content="Announcing OpenDeck platform"> <meta name="twitter:description" content=""> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content=""> <!-- Site Title --> <title> Announcing OpenDeck platform &#8226 Shantea Controls Blog </title> <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon"> <!-- gulp:css --> <link rel="stylesheet" href="/css/blog/app.css"> <!-- endgulp --> <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600" rel="stylesheet"> </head> <nav class="navbar navbar-default fixed-top"> <div class="container-fluid"> <div class="navbar-header"> <a href="/blog/blog.html"> <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="currentColor" class="bi bi-house" viewBox="0 0 16 16"> <path fill-rule="evenodd" d="M2 13.5V7h1v6.5a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5V7h1v6.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5zm11-11V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z"/> <path fill-rule="evenodd" d="M7.293 1.5a1 1 0 0 1 1.414 0l6.647 6.646a.5.5 0 0 1-.708.708L8 2.207 1.354 8.854a.5.5 0 1 1-.708-.708L7.293 1.5z"/> </svg> </a> <a href="/pages/tags/"> <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="currentColor" class="bi bi-hash" viewBox="0 0 16 16"> <path d="M8.39 12.648a1.32 1.32 0 0 0-.015.18c0 .305.21.508.5.508.266 0 .492-.172.555-.477l.554-2.703h1.204c.421 0 .617-.234.617-.547 0-.312-.188-.53-.617-.53h-.985l.516-2.524h1.265c.43 0 .618-.227.618-.547 0-.313-.188-.524-.618-.524h-1.046l.476-2.304a1.06 1.06 0 0 0 .016-.164.51.51 0 0 0-.516-.516.54.54 0 0 0-.539.43l-.523 2.554H7.617l.477-2.304c.008-.04.015-.118.015-.164a.512.512 0 0 0-.523-.516.539.539 0 0 0-.531.43L6.53 5.484H5.414c-.43 0-.617.22-.617.532 0 .312.187.539.617.539h.906l-.515 2.523H4.609c-.421 0-.609.219-.609.531 0 .313.188.547.61.547h.976l-.516 2.492c-.008.04-.015.125-.015.18 0 .305.21.508.5.508.265 0 .492-.172.554-.477l.555-2.703h2.242l-.515 2.492zm-1-6.109h2.266l-.515 2.563H6.859l.532-2.563z"/> </svg> </a>  </div> </div> </nav> <body class="post-template"> <div class="page-header grey-bg mt-5 pb-100 mb-100 pt-85 clearfix"> <div class="container"> <div class="row"> <div class="col"> <div class="author-text"> <div class="single-author-d w-100"> <div class="title"> <h2 class="mb-0 text-center">Announcing OpenDeck platform</h2> </div> <div class="post-meta d-flex"> <ul class="post-sp-meta list-inline mx-auto my-0"> <li class="list-inline-item"> <i class="fa fa-clock-o"></i>03 July 2014 </li> </ul> </div> </div> </div> </div> </div> </div> </div> <div class="post-content-area pb-100 clearfix"> <div class="container"> <div class="row"> <div class="col-lg-10 mx-auto"> <div class="s-post-details"> <div class="entry-content"><p>In the last few days, I’ve finally put all of my ideas into one, coherent project called OpenDeck. For those of you who don’t already know, <a href="https://www.youtube.com/watch?v=aMAuzVOpdlI">OpenDeck</a> <a href="https://www.youtube.com/watch?v=ChQUkpFITrs">started</a> as my vision of open source MIDI controller. I didn’t mean open source as just the code - it was a complete open hardware project, with vector design, electronic circuit, PCB schematic and last, but not least, the code itself freely available on my <a href="https://github.com/shanteacontrols/">GitHub</a> account. Eventually, OpenDeck source code got transformed into a helper library, which I happily use (it’s the base of Anandamidi and Tannin, two controllers I’ve built). I’ve spent few years tweaking it until I finally got super-stable code, so that when I build controllers, and something doesn’t really work, I am sure it’s not the code, but something hardware-related. Therefore, OpenDeck as a platform is really the only logical next step. What the hell am I talking about? Let’s see.</p> <h2 id="opendeck-backend">OpenDeck backend</h2> <p>The backend is actually the software which I already have. It’s split into few distinct parts:</p> <h3 id="opendeck-library">OpenDeck library</h3> <p>This library (for now) can handle:</p> <ul> <li>LED and button matrices</li> <li>blink and constant mode on each LED</li> <li>LED control via MIDI in</li> <li>start-up animation generation</li> <li>reading potentiometers directly connected to ATmega chip or multiplexed via external multiplexer</li> <li>inverting the potentiometer data</li> <li>turning potentiometers into 6-way switches (expandable)</li> <li>both digital and analogue debouncing</li> <li>MIDI channels selection</li> <li>long-press button mode (buttons can be configured to send a MIDI event after they’re pressed for defined time)</li> </ul> <p>For now, that’s it. As you can see, it already has lots of options, however, the features I’m planning to add are:</p> <ul> <li>rotary encoder support</li> <li>RGB LED support</li> <li>anything else?</li> </ul> <h3 id="hardwarereadspecific-library">HardwareReadSpecific library</h3> <p>This library talks directly with OpenDeck library. The only thing it contains is hardware-specific code. As an example, let’s see how OpenDeck library gets reading from whole column in button matrix:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void OpenDeck::readButtons()
{
    uint8_t buttonState = 0;
    uint8_t rowState = HardwareReadSpecific::readButtons();
    ...
}
</code></pre></div></div> <p>And readButtons() in HardwareReadSpecific looks like this (example taken from Tannin controller):</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>uint8_t HardwareReadSpecific::readButtons()
{
    //get the readings from all the rows
    return (PINB &amp; 0x0F);
}
</code></pre></div></div> <p>So, OpenDeck library contains only generic stuff, while HardwareReadSpecific deals directly with the hardware. This kind of implementation allows for extremly simple change of microcontroller used in the project.</p> <p>Apart from dealing with hardware directly, HardwareReadSpecific library also contains lots of switches. Using them, you can easily enable or disable LED or button matrix altogether, define debouncing time, blink duration and much more. Code is up on my GitHub account, so can check it yourself.</p> <h3 id="midi-library">MIDI library</h3> <p>This is the only part of the code which isn’t written by myself, although I’ve trimmed out the parts from it which I don’t need. This library is responsible for actually sending and receiving MIDI data. The most powerful part of it is exactly the incoming data parser. Library is written by Francois Best, and you can find the latest version of it on his <a href="https://github.com/FortySevenEffects/arduino_midi_library">GitHub</a> account. It’s worth of mention that latest version is 4.2, while I’m using older-but-proven modification of 3.2 version (also available on my GitHub, redistibuted under GPLv3 conditions).</p> <h3 id="main-file"><code class="language-plaintext highlighter-rouge">main</code> file</h3> <p>If you’re ever done any programming in your life, you already know what main file is. If you haven’t, then you’ve also probably skipped this entire section. But, simply put, main is where your code starts. In microcontroller programming, it usually has two distinctive parts: setup, in which you call constructors, initialise everything you need, and run some code which only runs on start-up, such as LED animation, and loop, which runs until you disconnect power from your microcontroller. This file calls OpenDeck functions. After OpenDeck library gets stable data from inputs, it uses callbacks to MIDI library to actually send the data, or store the incoming stuff.</p> <p>I’m really happy about the modularity of my code, since this way, I can develop each of the four parts independently, without breaking whole code.</p> <h2 id="opendeck-frontend">OpenDeck frontend</h2> <p>Okay, <a href="http://youtu.be/GhqXWybI6xQ?t=1m21s">how about we make it interesting</a>? Even though I’ve went through pretty-much all of the code which powers my MIDI controllers, I consider it only to be backend. So, what would be frontend? GUI application, of course! If all of this sounds familiar, well then, it should, because Livid Instruments makes everything I’m talking about in this entire post. <a href="http://lividinstruments.com/hardware_builder.php">Go check it yourself</a>. What they’ve done is pretty amazing. They’ve got a PCB board on which you can connect anything you like, pots, encoders, LEDs etc. It all comes pre-programmed, it’s MIDI compliant, and it also has GUI configuration. There’s only two problems really:</p> <ol> <li>Only two PCB sizes (one costs 49 and other is 189$, which makes for quite a gap for projects of mid-size)</li> <li>It’s not open-sourced</li> </ol> <p>Therefore, I’m basically building <a href="http://en.wikipedia.org/wiki/Clean_room_design">clean-room</a> implementation based on what I already have. As I’ve already explained, my backend is very modular, so adapting it for other hardware only requires small changes in HardwareReadSpecific library. As far as PCB is concerned, I’ve created design for reference board, which I’ll send to manufacturing after I’m done checking for any errors. The board contains total of 16 analogue inputs, 32 digital inputs (32 buttons or 16 enoders, once I’m done implementing it in software), and 32 digital outputs for LEDs. What powers that board is Arduino Pro Mini, great little tool (also very, very cheap). Board also has headers for my USB MIDI PCB board, which I’ve talked about in my last post. Notice, however, that this is only reference board. Final version will have both ATmega and AU-123 chip integrated into one board, so that there’s no messing with drivers or converters, straight plug-and-play. I’m also planning to have ICSP header, for those feeling adventurous, so that even the ATmega chip is reprogrammable. Of course, board design, as with circuit schematic is going to be freely available, just like software itself.</p> <h3 id="gui">GUI</h3> <p>I’m only laying ideas here, I don’t even have design mockups yet, however, these are the features which I’m initially planning to have in my configuration software:</p> <ul> <li>Testing of whole controller, that is, checking for whether all buttons, encoders, LEDs and pots actually work</li> <li>Controller configuration, which would involve everything from MIDI channel selection, flipping of potentiometer data (or anything else), start-up animation generation etc.</li> <li>Controller programming via custom SysEx messages (that could be a challenge)</li> </ul> <p>I am planning to have GUI running across all platforms, but since I only use Windows, that’s going to be a priority. Also, because of cross-platform availability, source is probably going to be written in Java, unless someone has better ideas. While we’re at it, this whole thing is a pretty big project, so I am looking for contributors. If you’re feeling you can help me developing modular, open hardware MIDI building platform, please let me know!</p> </div> <div class="inner-padding fullwidth pb-60"> <div class="post-share-icon clearfix"> <div class="tag-list"> <div class="row"> <div class="col-md-8"> <p class="float-left pr-2"><strong>Tags :</strong></p> <ul class="float-left"> <li> <a href="/tag/announce/blog.html"> #announce</a> </li> <li> <a href="/tag/opendeck/blog.html"> #opendeck</a> </li> <li> <a href="/tag/programming/blog.html"> #programming</a> </li> </ul> </div> <div class="col-md-4"></div> </div> </div> </div> </div> </div> <div class="categories-carousel pb-60 clearfix"> <div class="section-title"> <h3>Related Posts</h3> </div> <div class="related-post-carousel owl-carousel"> <div class="single-item"> <div class="categories-post-image"> <div class="categories-post-hover text-center"> <div class="hover-details"> <div class="post-link"> <h3> <a href="/2022/06/24/new-pco-features/">Using The New Program Change Offset Features In OpenDeck v7.3.0</a> </h3> <div class="btn-read"> <a href="/2022/06/24/new-pco-features/">Read More</a> </div> </div> </div> </div> </div> </div> <div class="single-item"> <div class="categories-post-image"> <img src="/images/blog/od3/5.png" alt="OpenDeck boards v3 now available"> <div class="categories-post-hover text-center"> <div class="hover-details"> <div class="post-link"> <h3> <a href="/2022/06/20/opendeck-boards-v3-available-now/">OpenDeck boards v3 now available</a> </h3> <div class="btn-read"> <a href="/2022/06/20/opendeck-boards-v3-available-now/">Read More</a> </div> </div> </div> </div> </div> </div> <div class="single-item"> <div class="categories-post-image"> <img src="/images/blog/od3/2.png" alt="OpenDeck boards v3 in development"> <div class="categories-post-hover text-center"> <div class="hover-details"> <div class="post-link"> <h3> <a href="/2022/04/09/opendeck-boards-v3-in-development/">OpenDeck boards v3 in development</a> </h3> <div class="btn-read"> <a href="/2022/04/09/opendeck-boards-v3-in-development/">Read More</a> </div> </div> </div> </div> </div> </div> <div class="single-item"> <div class="categories-post-image"> <img src="/images/blog/ble.png" alt="OpenDeck v7"> <div class="categories-post-hover text-center"> <div class="hover-details"> <div class="post-link"> <h3> <a href="/2022/04/09/opendeck-7/">OpenDeck v7</a> </h3> <div class="btn-read"> <a href="/2022/04/09/opendeck-7/">Read More</a> </div> </div> </div> </div> </div> </div> <div class="single-item"> <div class="categories-post-image"> <img src="/images/blog/cover_opendeck_v6.jpg" alt="OpenDeck v6 - what comes next?"> <div class="categories-post-hover text-center"> <div class="hover-details"> <div class="post-link"> <h3> <a href="/2021/11/23/opendeck-6-what-comes-next/">OpenDeck v6 - what comes next?</a> </h3> <div class="btn-read"> <a href="/2021/11/23/opendeck-6-what-comes-next/">Read More</a> </div> </div> </div> </div> </div> </div> <div class="single-item"> <div class="categories-post-image"> <img src="/images/blog/166086360_207954164335998_7262799458133236482_n.jpg" alt="Regarding DubFocus"> <div class="categories-post-hover text-center"> <div class="hover-details"> <div class="post-link"> <h3> <a href="/2021/03/30/regarding-dubfocus/">Regarding DubFocus</a> </h3> <div class="btn-read"> <a href="/2021/03/30/regarding-dubfocus/">Read More</a> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> <footer> <div class="footer-area clearfix"> <div class="container"> <div class="row"> <div class="col-lg-12"> <div class="footer-logo pb-100 pt-100 text-center"> <a href="https://shanteacontrols.com"> <img src="/images/logo_notext_inv.svg" alt="Shantea Controls"> </a> </div> </div> </div> <div class="row pb-60"> <div class="col-lg-3 col-md-6"> <div class="footer-widget"> <div class="widget-title"> <h4> About </h4> </div> <div class="widget-text"> <p>Shantea Controls Blog</p> <div class="social-link"> <ul> </ul> </div> </div> </div> </div> <div class="col-lg-3 col-md-6"> <div class="footer-widget"> <div class="widget-title"> <h4>Recent posts</h4> </div> <div class="widget-text"> <div class="r-post"> <ul> <li><a href="/2022/06/24/new-pco-features/">Using The New Program Change Offset Features In OpenDeck v7.3.0 </a> </li> <li><a href="/2022/06/20/opendeck-boards-v3-available-now/">OpenDeck boards v3 now available </a> </li> <li><a href="/2022/04/09/opendeck-boards-v3-in-development/">OpenDeck boards v3 in development </a> </li> <li><a href="/2022/04/09/opendeck-7/">OpenDeck v7 </a> </li> </ul> </div> </div> </div> </div> <div class="col-lg-3 col-md-6"> <div class="footer-widget"> <div class="widget-title"> <h4> Links</h4> </div> <div class="widget-text"> <div class="widget-link"> <ul> <ul> <li><a href="/" target="_blank">Main page</a></li> <li><a href="https://youtube.com/shanteacontrols" target="_blank">YouTube</a></li> <li><a href="https://www.facebook.com/shanteacontrolsmidi" target="_blank">Facebook</a></li> <li><a href="https://github.com/shanteacontrols/OpenDeck" target="_blank">GitHub</a></li> </ul> </ul></div> </div> </div> </div> </div> <div class="row"> <div class="col"> <div class="footer-text text-center"> <p class="footer-address"> &copy; 2024 Shantea Controls | Developed by <a href="https://themeix.com">themeix</a></p> </div> </div> </div> </div> </div> </footer> <script src="/js/blog/build.js"></script> </body> </html> 